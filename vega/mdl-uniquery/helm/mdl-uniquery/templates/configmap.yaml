apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Values.moduleName }}-cm
  namespace: {{ .Values.namespace }}
data:
  uniquery-config.yaml: |
    server:
      {{- range $key, $val := .Values.config.server }}
      {{- if eq $key "fixedQuerySteps"}}
      {{ $key }}: {{ $val | toJson }}
      {{- else }}
      {{ $key }}: {{ $val }}
      {{- end }}
      {{- end }}
    log:
      {{- toYaml .Values.config.log | nindent 6 }}
    pool:
      {{- toYaml .Values.config.pool | nindent 6 }}
    promql:
      {{- toYaml .Values.config.promql | nindent 6 }}
    trace:
      {{- toYaml .Values.config.trace | nindent 6 }}
    observability:
      {{- toYaml .Values.config.observability | nindent 6 }}
    thirdParty:
      {{- toYaml .Values.config.thirdParty | nindent 6 }}
    kafka:
      {{- toYaml .Values.config.kafka | nindent 6 }}
    depServices: 
      {{- toYaml .Values.depServices | nindent 6 }}

  dm_svc.conf: |
    TIME_ZON=(480)
    LANGUAGE=(cn)
    DM=({{ .Values.depServices.rds.host }})
    [DM]
    LOGIN_MODE=(1)